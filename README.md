# Claude Bot ü§ñ\n\nTypeScript implementation of Claude Code mention detection and automation system for GitHub repositories, designed to run on Raspberry Pi and execute Claude Code CLI on local projects.\n\n## üéØ Purpose\n\nClaude Bot monitors GitHub repositories for `@claude` mentions and automatically executes Claude Code CLI commands on your local project directory. Perfect for:\n\n- **Raspberry Pi automation**: Always-on monitoring with minimal resource usage\n- **Local development**: Claude Code works directly on your local project files\n- **GitHub integration**: Seamless integration with GitHub Issues and Pull Requests\n- **Token optimization**: Smart change detection to minimize Claude API usage\n\n## üèóÔ∏è Project Structure\n\n```\n/home/pi/Develop/\n‚îú‚îÄ‚îÄ claude-bot/           # This repository - Claude Bot system\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ package.json\n‚îÇ   ‚îú‚îÄ‚îÄ .env              # Configuration\n‚îÇ   ‚îî‚îÄ‚îÄ mention_tracker.db\n‚îî‚îÄ‚îÄ target-project/       # Your project - Claude Code execution target\n    ‚îú‚îÄ‚îÄ src/\n    ‚îú‚îÄ‚îÄ README.md\n    ‚îú‚îÄ‚îÄ package.json\n    ‚îî‚îÄ‚îÄ .git/            # Connected to GitHub\n```\n\n## ‚ú® Features\n\n- **Smart Mention Detection**: Automatically detects `@claude` mentions in GitHub Issues and PRs\n- **Local Project Execution**: Claude Code CLI runs in your specified target project directory\n- **Configurable CLI Path**: Support for Nodenv, NVM, and custom Claude CLI installations\n- **Token Optimization**: Efficient change detection using SHA256 hashing to minimize Claude Code API usage\n- **SQLite Database**: Reliable tracking of processed content and mention history\n- **Comprehensive Logging**: Detailed logging with Winston for monitoring and debugging\n- **Cron Scheduling**: Configurable intervals for detection and backup operations\n- **Type Safety**: Full TypeScript implementation with strict typing\n- **Multi-Command Support**: Various Claude Code commands (implement, review, analyze, etc.)\n- **Graceful Error Handling**: Robust error handling and recovery mechanisms\n\n## üöÄ Quick Start\n\n### 1. Installation\n\n```bash\n# Create development directory\nmkdir -p /home/pi/Develop\ncd /home/pi/Develop\n\n# Clone Claude Bot\ngit clone https://github.com/sotaroNishioka/claude-bot.git\ncd claude-bot\nnpm install\n\n# Create your target project (or clone existing)\ncd ../\nmkdir target-project  # or: git clone your-project.git target-project\ncd target-project\ngit init  # if new project\n```\n\n### 2. Configuration\n\n```bash\ncd /home/pi/Develop/claude-bot\ncp .env.example .env\n```\n\nEdit `.env` with your settings:\n\n```env\n# GitHub Configuration\nGITHUB_TOKEN=ghp_your_personal_access_token\nGITHUB_OWNER=your_username  \nGITHUB_REPO=your_repository_name\n\n# Claude Code Configuration\nCLAUDE_API_KEY=your_claude_api_key\nCLAUDE_CLI_PATH=/usr/local/bin/claude  # or custom path\nDAILY_TOKEN_LIMIT=45000\n\n# Project Paths\nTARGET_PROJECT_PATH=../target-project\nCLAUDE_BOT_PATH=/home/pi/Develop/claude-bot\n\n# Detection Settings\nDETECTION_INTERVAL=\"*/5 * * * *\"  # Every 5 minutes\n```\n\n### 3. Claude CLI Path Configuration\n\nDepending on your Node.js installation:\n\n```bash\n# Standard installation\nCLAUDE_CLI_PATH=/usr/local/bin/claude\n\n# Nodenv\nCLAUDE_CLI_PATH=/home/pi/.nodenv/shims/claude\n\n# NVM\nCLAUDE_CLI_PATH=/home/pi/.nvm/versions/node/v18.19.0/bin/claude\n\n# Custom installation\nCLAUDE_CLI_PATH=/home/pi/.local/bin/claude\n```\n\n### 4. Setup and Test\n\n```bash\nnpm run build\nnpm run setup\nnpm run dev -- test-config\n```\n\n### 5. Run\n\n```bash\n# Development mode\nnpm run dev -- start\n\n# Production mode  \nnpm run build && npm start\n\n# Single detection cycle (testing)\nnpm run dev -- run-once\n```\n\n## üìñ Usage\n\nOnce running, Claude Bot will automatically detect `@claude` mentions in:\n\n- ‚úÖ Issue descriptions\n- ‚úÖ Issue comments  \n- ‚úÖ Pull Request descriptions\n- ‚úÖ Pull Request comments\n\n### Available Commands\n\n| Command | Description | Example |\n|---------|-------------|----------|\n| `@claude implement [details]` | Implement the issue/PR in target project | `@claude implement with error handling` |\n| `@claude review [focus]` | Code review with specific focus | `@claude review security and performance` |\n| `@claude analyze [aspect]` | Analyze code or requirements | `@claude analyze architecture patterns` |\n| `@claude improve [area]` | Suggest improvements | `@claude improve error handling` |\n| `@claude test [type]` | Generate tests | `@claude test unit tests for edge cases` |\n| `@claude help` | Show help message | `@claude help` |\n\n### Example Mentions\n\n```\n@claude implement this authentication feature with JWT tokens and proper error handling\n\n@claude review this PR, especially looking at memory usage and potential security vulnerabilities\n\n@claude analyze the current database schema and suggest performance improvements\n```\n\n**Important**: Claude Code will execute in your `target-project` directory, making actual changes to your local files.\n\n## üîß Configuration\n\n### Environment Variables\n\n| Variable | Description | Default |\n|----------|-------------|---------|\n| `GITHUB_TOKEN` | GitHub Personal Access Token | **Required** |\n| `GITHUB_OWNER` | Repository owner username | **Required** |\n| `GITHUB_REPO` | Repository name | **Required** |\n| `CLAUDE_API_KEY` | Claude API key for Claude Code | **Required** |\n| `CLAUDE_CLI_PATH` | Path to Claude CLI executable | `claude` |\n| `TARGET_PROJECT_PATH` | Path to target project directory | `../target-project` |\n| `CLAUDE_BOT_PATH` | Path to Claude Bot directory | `current directory` |\n| `DAILY_TOKEN_LIMIT` | Maximum Claude tokens per day | `45000` |\n| `DETECTION_INTERVAL` | Cron expression for mention detection | `*/5 * * * *` |\n| `BACKUP_INTERVAL` | Cron expression for database backup | `0 2 * * *` |\n| `LOG_LEVEL` | Logging level (debug, info, warn, error) | `info` |\n| `DATABASE_PATH` | SQLite database file path | `./mention_tracker.db` |\n\n### GitHub Token Permissions\n\nRequired permissions for GitHub Personal Access Token:\n- `repo` (Full repository access)\n- `read:org` (Read organization membership)\n\n## üê≥ Deployment Options\n\n### Raspberry Pi (Recommended)\n\nPerfect for always-on monitoring with minimal resource usage:\n\n```bash\n# Install Node.js\ncurl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt-get install -y nodejs\n\n# Install Claude CLI\ncurl -fsSL https://claude.ai/cli/install.sh | sh\nclaude auth login\n\n# Setup as systemd service\nsudo cp deployment/claude-bot.service /etc/systemd/system/\nsudo systemctl enable claude-bot\nsudo systemctl start claude-bot\n```\n\n### Docker\n\n```bash\ndocker build -t claude-bot .\ndocker run -d --name claude-bot --env-file .env -v /path/to/target-project:/app/target-project claude-bot\n```\n\n### PM2 (Process Manager)\n\n```bash\nnpm install -g pm2\npm2 start ecosystem.config.js\npm2 startup\npm2 save\n```\n\n## üìä Monitoring\n\n### Status Check\n\n```bash\nnpm run dev -- status\n```\n\nOutput example:\n```json\n{\n  \"isRunning\": true,\n  \"repository\": {\n    \"name\": \"my-project\",\n    \"language\": \"TypeScript\",\n    \"stars\": 42\n  },\n  \"todayStats\": {\n    \"totalChecks\": 288,\n    \"newMentions\": 5,\n    \"processedMentions\": 5,\n    \"tokensUsed\": 12500\n  },\n  \"configuration\": {\n    \"targetProject\": \"/home/pi/Develop/target-project\",\n    \"claudeCli\": \"/home/pi/.nodenv/shims/claude\"\n  }\n}\n```\n\n### Logs\n\n```bash\n# View real-time logs\ntail -f ./logs/claude-bot.log\n\n# View error logs only\ngrep ERROR ./logs/claude-bot.log\n\n# View today's mention activity\ngrep \"mention detected\" ./logs/claude-bot.log | grep $(date +%Y-%m-%d)\n```\n\n## üéØ Token Optimization\n\nClaude Bot is designed for efficient token usage:\n\n- **Change Detection**: Only processes content that has actually changed\n- **Content Hashing**: SHA256 comparison prevents duplicate processing  \n- **Daily Limits**: Configurable token budgets with automatic enforcement\n- **Smart Scheduling**: Non-critical tasks run during low-usage hours\n\n### Token Usage Estimates\n\n| Action | Estimated Tokens | Description |\n|--------|------------------|-------------|\n| `implement` | 3000-8000 | Code generation and PR creation |\n| `review` | 1500-3000 | Code analysis and feedback |\n| `analyze` | 1000-2000 | Requirements and architecture analysis |\n| `improve` | 2000-2500 | Optimization suggestions |\n| `test` | 1500-2000 | Test generation |\n| `help` | 0 | Static response |\n\n## üîç Troubleshooting\n\n### Common Issues\n\n1. **Claude CLI not found**:\n   ```bash\n   # Check if Claude CLI is installed\n   which claude\n   \n   # Update CLAUDE_CLI_PATH in .env\n   CLAUDE_CLI_PATH=/full/path/to/claude\n   ```\n\n2. **Target project not found**:\n   ```bash\n   # Verify target project exists\n   ls -la ../target-project\n   \n   # Update TARGET_PROJECT_PATH in .env\n   TARGET_PROJECT_PATH=/full/path/to/target-project\n   ```\n\n3. **Permission issues**:\n   ```bash\n   # Ensure write permissions to target project\n   chmod 755 ../target-project\n   \n   # Check if target project is a git repository\n   cd ../target-project && git status\n   ```\n\n### Debug Mode\n\n```bash\n# Enable debug logging\nDEBUG=true LOG_LEVEL=debug npm run dev -- start\n```\n\n## üìö Documentation\n\n- [Setup Guide](./docs/SETUP.md) - Detailed installation and configuration\n- [API Reference](./docs/API.md) - Complete API documentation\n- [Troubleshooting](./docs/TROUBLESHOOTING.md) - Common issues and solutions\n\n## ü§ù Support\n\n- üìñ Check the [documentation](./docs/)\n- üêõ Report issues on [GitHub Issues](https://github.com/sotaroNishioka/claude-bot/issues)\n- üí¨ Ask questions in [GitHub Discussions](https://github.com/sotaroNishioka/claude-bot/discussions)\n\n## üìÑ License\n\nThis project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.\n\n## üôè Acknowledgments\n\n- [Claude Code](https://claude.ai/code) - AI-powered development automation\n- [Octokit](https://github.com/octokit/octokit.js) - GitHub API client\n- [Winston](https://github.com/winstonjs/winston) - Logging library\n- [node-cron](https://github.com/node-cron/node-cron) - Task scheduling\n\n---\n\n**Made with ‚ù§Ô∏è for efficient Claude Code automation on Raspberry Pi**"